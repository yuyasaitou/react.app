;(function(c){var d=c.fitSidebar=function(h,i){var b=this,a=b.config=c.extend({},d.defaults,i);a.target=c(h).addClass("fit-sidebar");a.blank=c("<div/>").addClass(d.id+"-blank").insertBefore(a.target);a.blank.css("border","solid 1px #fff");a.blank.css({"margin-top":a.target.css("margin-top"),"margin-right":a.target.css("margin-right"),"margin-bottom":a.target.css("margin-bottom"),"margin-left":a.target.css("margin-left"),"border-top-width":a.target.css("border-top-width"),"border-right-width":a.target.css("border-right-width"),"border-bottom-width":a.target.css("border-bottom-width"),"border-left-width":a.target.css("border-left-width"),"padding-top":a.target.css("padding-top"),"padding-right":a.target.css("padding-right"),"padding-bottom":a.target.css("padding-bottom"),"padding-left":a.target.css("padding-left")});a.wrapper=c(a.target).parents(a.wrapper);a._win=c(window).on("scroll",function(){b.adjustPosition()}).on("resize",function(){a.target.hasClass("for-chrome-bug");b.adjustPosition()});setTimeout(function(){b.adjustPosition()},0)};c.extend(c.fitSidebar.prototype,{adjustPosition:function(){var b=this,a=b.config;if(a._win.width()<a.responsiveWidth){a.wrapper.removeClass(a.fixedClassName);a.wrapper.addClass(a.noFixedClassName);a.target.removeClass(d.id+"-fixed");a.blank.hide();a.target.width("auto");a.direction=null;return}a.wrapper.addClass(a.fixedClassName);a.wrapper.removeClass(a.noFixedClassName);a.target.addClass(d.id+"-fixed");var l=a.blank.show().offset();var m=a._win.scrollTop();var n=a.target.outerHeight();var o=n-a._win.height();if(o<0){o=0}if(!a.direction){a.lastFixedTop=a.lastDownFixedTop=a.lastUpFixedTop=l.top-m;a.lastScrollTop=a.lastDownScrollTop=a.lastUpScrollTop=m}a.target.width(a.blank.width());a.blank.height(a.target.height());a.direction=m<a.lastScrollTop?"up":"down";var q=function(){var f=a.lastUpFixedTop+(a.lastUpScrollTop-m);if(f<0){if(f+o<0){f=-o;var g=a.wrapper.offset().top+a.wrapper.height();var e=m+n+f;if(e>g){f=(g-m)-n}}}a.target.css({top:f,position:"fixed",bottom:"auto"});a.lastDownFixedTop=f;a.lastDownScrollTop=m};var p=function(){var e=a.lastDownFixedTop+(a.lastDownScrollTop-m);if(e>0){e=l.top-m;if(e<0){e=0}}a.target.css({top:e,bottom:"auto"});a.lastUpFixedTop=e;a.lastUpScrollTop=m};if(a.direction=="down"){q()}else{p()}a.lastFixedTop=top;a.lastScrollTop=m}});c.fn.fitSidebar=function(a){return this.each(function(){var b=c(this);b.data(d.id,new c.fitSidebar(b,a))})};c.extend(d,{defaults:{wrapper:"body",responsiveWidth:0,fixedClassName:"fit-sidebar-fixed-now",noFixedClassName:"fit-sidebar-no-fixed-now"},id:"fit-sidebar"})})(jQuery);
